<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>çˆ¸åª½å°å¡</title>

<link href="https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@400;500&display=swap" rel="stylesheet">

<style>
:root {
  --bg: #fff6f8;
  --card-bg: #ffffff;
  --accent: #f2b8c6;
  --border: #f3d6dd;
  --text: #4a3f42;
  --shadow: 0 12px 24px rgba(0,0,0,0.08);
}

body {
  margin: 0;
  font-family:
    "Noto Serif TC",
    "DFKai-SB",
    "æ¨™æ¥·é«”",
    serif;
  background: var(--bg);
  color: var(--text);
  height: 100vh;
  display: flex;
  flex-direction: column;
}

header {
  text-align: center;
  padding: 14px;
  font-weight: 500;
}

/* ===== Main ===== */
main {
  flex: 1;
  overflow-y: auto;
  padding-bottom: 80px;
  display: flex;
  justify-content: center;
  align-items: center;
}

/* ===== æŠ½å¡å€ ===== */
#swipeView {
  display: flex;
  justify-content: center;
  align-items: center;
}

.card {
  width: 62vw;
  max-width: 280px;
  aspect-ratio: 2.5 / 3.5;
  background: var(--card-bg);
  border-radius: 20px;
  box-shadow: var(--shadow);
  padding: 22px;
  font-size: 17px;
  line-height: 1.7;
  text-align: center;
  display: flex;
  align-items: center;
  justify-content: center;
  user-select: none;
  touch-action: pan-y;
  border: 1px solid var(--border);
  letter-spacing: 0.03em;
  transition: transform 0.3s ease, opacity 0.3s ease;
}

/* ===== å¡ç‰‡æ±  ===== */
#savedView {
  width: 100%;
  max-width: 420px;
  padding: 12px;
}

/* åˆ†é¡æ¨™ç±¤ */
.category-bar {
  display: flex;
  gap: 8px;
  overflow-x: auto;
  margin-bottom: 12px;
}

.category {
  padding: 6px 14px;
  border-radius: 999px;
  background: #fff;
  border: 1px solid var(--border);
  font-size: 14px;
  white-space: nowrap;
}

/* å¡ç‰‡ç¶²æ ¼ */
.card-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(110px, 1fr));
  gap: 12px;
}

/* ç¸®å°å¡ç‰‡ */
.small-card {
  aspect-ratio: 2.5 / 3.5;
  background: #fff;
  border-radius: 14px;
  padding: 10px;
  font-size: 13px;
  line-height: 1.5;
  box-shadow: var(--shadow);
  border: 1px solid var(--border);
  cursor: grab;
}

/* ===== Bottom Bar ===== */
.bottom-bar {
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  height: 64px;
  display: flex;
  justify-content: space-around;
  align-items: center;
  background: rgba(255,255,255,0.95);
  border-top: 1px solid var(--border);
}

.bottom-bar button {
  background: none;
  border: none;
  font-size: 24px;
  opacity: 0.4;
}

.bottom-bar button.active {
  opacity: 1;
  color: var(--accent);
}

.hidden { display: none; }
</style>
</head>

<body>

<header id="title">æŠ½å¡</header>

<main>
  <!-- æŠ½å¡å€ -->
  <div id="swipeView">
    <div class="card" id="card"></div>
  </div>

  <!-- å¡ç‰‡æ±  -->
  <div id="savedView" class="hidden">
    <div class="category-bar">
      <div class="category" data-cat="all">å…¨éƒ¨</div>
      <div class="category" data-cat="sleep">ç¡çœ </div>
      <div class="category" data-cat="feed">é¤µé£Ÿ</div>
      <div class="category" data-cat="safe">å®‰å…¨æ„Ÿ</div>
    </div>

    <div class="card-grid" id="cardGrid"></div>
  </div>
</main>

<div class="bottom-bar">
  <button id="btnSwipe" class="active">ğŸƒ</button>
  <button id="btnSaved">â­</button>
</div>

<script>
/* ===== å¡ç‰Œè³‡æ–™ ===== */
const sentences = [
  "åŸä¾†å¯¶å¯¶åœ¨åª½åª½è‚šå­è£¡æœƒæ‰“å—",
  "æ‡·å­•ä¹‹å¾Œæ‰çŸ¥é“ï¼Œæ´—ç‰™å¥ä¿å¾åŠå¹´ä¸€æ¬¡è®Šæˆä¸‰å€‹æœˆä¸€æ¬¡",
  "å°åŒ—å¸‚æ”¿åºœæœ‰è£œåŠ©ä¸€èƒï¼„8000çš„è¨ˆç¨‹è»Šæ´¥è²¼",
  "æ‡·å­•ä¹‹å¾Œæ‰çŸ¥é“ï¼Œ34æ­²ä»¥ä¸Šå°±æ˜¯é«˜é½¡ç”¢å©¦ï¼Œåšç¾Šè†œç©¿åˆºæ”¿åºœæœƒæœ‰è£œåŠ©",
  "åŸä¾†æ‡·å­•ä»¥å¾Œï¼ŒçœŸçš„æœƒéå¸¸æ€•ç†±ï¼Œé€£æ‚¶ä¸€é»éƒ½æœƒå—ä¸äº†",
  "æ‡·å­•ä»¥å¾Œæ‰çŸ¥é“ï¼ŒåŸä¾†å¯éº—éœ²è£¡é¢æœ‰èŠå§†é…’ï¼Œä¸èƒ½åƒï¼Œææ‹‰ç±³è˜‡ä¹Ÿæ˜¯",
  "æ‡·å­•ä»¥å¾Œæ‰çŸ¥é“ï¼Œå¾ˆå¤šå“ç‰Œå½Œæœˆè›‹ç³•è©¦åƒè¦32å‘¨ä»¥ä¸Šæ‰èƒ½ç”³è«‹ï¼Œæ‰€ä»¥ä¸ç”¨å¤ªæ—©æ±ºå®š"
];

/* ===== æ´—ç‰Œå¾Œä¾åºæŠ½ ===== */
let deck = [];
let deckIndex = 0;

function shuffle(arr) {
  for (let i = arr.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [arr[i], arr[j]] = [arr[j], arr[i]];
  }
  return arr;
}

/* ===== ç‹€æ…‹ ===== */
let currentText = "";
let savedCards = [];
let isAnimating = false;

/* ===== DOM ===== */
const card = document.getElementById("card");
const savedView = document.getElementById("savedView");
const swipeView = document.getElementById("swipeView");
const cardGrid = document.getElementById("cardGrid");
const title = document.getElementById("title");

/* ===== æŠ½å¡ ===== */
function drawCard() {
  if (deck.length === 0 || deckIndex >= deck.length) {
    deck = shuffle([...sentences]);
    deckIndex = 0;
  }
  currentText = deck[deckIndex++];
  card.textContent = currentText;
  card.style.transform = "translateX(0) rotate(0deg)";
  card.style.opacity = 1;
}
drawCard();

/* ===== æ»‘å‹• ===== */
let startX = 0, currentX = 0, dragging = false;

card.addEventListener("pointerdown", e => {
  if (isAnimating) return;
  startX = e.clientX;
  dragging = true;
  card.setPointerCapture(e.pointerId);
});

card.addEventListener("pointermove", e => {
  if (!dragging || isAnimating) return;
  currentX = e.clientX - startX;
  card.style.transform = `translateX(${currentX}px) rotate(${currentX/12}deg)`;
});

card.addEventListener("pointerup", () => {
  if (isAnimating) return;
  dragging = false;

  if (currentX > 120) {
    savedCards.push({ text: currentText, cat: "all" });
    flyOut(1);
  } else if (currentX < -120) {
    flyOut(-1);
  } else {
    card.style.transform = "translateX(0) rotate(0deg)";
  }
  currentX = 0;
});

function flyOut(dir) {
  isAnimating = true;
  card.style.transform = `translateX(${dir*500}px) rotate(${dir*25}deg)`;
  card.style.opacity = 0;

  setTimeout(() => {
    card.style.transition = "none";
    drawCard();
    card.offsetHeight;
    card.style.transition = "transform 0.3s ease, opacity 0.3s ease";
    isAnimating = false;
  }, 300);
}

/* ===== å¡ç‰‡æ±  ===== */
function renderSaved(filter="all") {
  cardGrid.innerHTML = "";
  savedCards
    .filter(c => filter === "all" || c.cat === filter)
    .forEach((c, i) => {
      const div = document.createElement("div");
      div.className = "small-card";
      div.textContent = c.text;
      div.draggable = true;
      div.ondragstart = e => e.dataTransfer.setData("index", i);
      cardGrid.appendChild(div);
    });
}

/* ===== åˆ†é¡æ‹–æ‹‰ ===== */
document.querySelectorAll(".category").forEach(cat => {
  cat.onclick = () => renderSaved(cat.dataset.cat);
  cat.ondragover = e => e.preventDefault();
  cat.ondrop = e => {
    const i = e.dataTransfer.getData("index");
    savedCards[i].cat = cat.dataset.cat;
    renderSaved(cat.dataset.cat);
  };
});

/* ===== åˆ‡æ› ===== */
btnSwipe.onclick = () => {
  swipeView.classList.remove("hidden");
  savedView.classList.add("hidden");
  title.innerText = "æŠ½å¡";
};

btnSaved.onclick = () => {
  swipeView.classList.add("hidden");
  savedView.classList.remove("hidden");
  title.innerText = "å¡ç‰Œæ± ";
  renderSaved();
};
</script>

</body>
</html>